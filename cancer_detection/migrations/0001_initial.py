# Generated by Django 6.0 on 2026-01-21 16:16

import django.db.models.deletion
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='CancerImageAnalysis',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('image', models.ImageField(upload_to='cancer_images/%Y/%m/%d/')),
                ('image_type', models.CharField(choices=[('xray', 'X-Ray Scan'), ('ct', 'CT Scan'), ('mri', 'MRI Scan'), ('tumor', 'Tumor Image'), ('biopsy', 'Biopsy Image'), ('ultrasound', 'Ultrasound'), ('other', 'Other')], default='other', max_length=20)),
                ('original_filename', models.CharField(max_length=255)),
                ('tumor_detected', models.BooleanField(default=False)),
                ('tumor_type', models.CharField(blank=True, max_length=100, null=True)),
                ('tumor_stage', models.CharField(blank=True, max_length=50, null=True)),
                ('tumor_size_mm', models.FloatField(blank=True, null=True)),
                ('tumor_location', models.CharField(blank=True, max_length=200, null=True)),
                ('genetic_profile', models.JSONField(blank=True, default=dict)),
                ('comorbidities', models.JSONField(blank=True, default=list)),
                ('analysis_data', models.JSONField(blank=True, default=dict)),
                ('detection_confidence', models.FloatField(default=0.0)),
                ('stage_confidence', models.FloatField(default=0.0)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('notes', models.TextField(blank=True, null=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='cancer_analyses', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'cancer_image_analyses',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='EvidenceSource',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('title', models.CharField(max_length=500)),
                ('source_type', models.CharField(choices=[('nccn_guideline', 'NCCN Guideline'), ('esmo_guideline', 'ESMO Guideline'), ('asco_guideline', 'ASCO Guideline'), ('pubmed_study', 'PubMed Study'), ('clinical_trial', 'Clinical Trial'), ('case_report', 'Case Report'), ('systematic_review', 'Systematic Review'), ('meta_analysis', 'Meta-Analysis'), ('other', 'Other')], max_length=50)),
                ('authors', models.CharField(blank=True, max_length=500, null=True)),
                ('publication_year', models.IntegerField(blank=True, null=True)),
                ('journal_or_organization', models.CharField(blank=True, max_length=300, null=True)),
                ('pmid', models.CharField(blank=True, db_index=True, max_length=50, null=True, unique=True)),
                ('doi', models.CharField(blank=True, max_length=100, null=True)),
                ('guideline_version', models.CharField(blank=True, max_length=100, null=True)),
                ('guideline_url', models.URLField(blank=True, null=True)),
                ('abstract', models.TextField(blank=True, null=True)),
                ('key_findings', models.TextField(blank=True, null=True)),
                ('evidence_strength', models.CharField(choices=[('high', 'High - Category 1'), ('moderate', 'Moderate - Category 2A/2B'), ('low', 'Low - Category 3')], default='moderate', max_length=20)),
                ('cancer_types', models.JSONField(blank=True, default=list)),
                ('treatment_types', models.JSONField(blank=True, default=list)),
                ('biomarkers', models.JSONField(blank=True, default=list)),
                ('full_text', models.TextField(blank=True, null=True)),
                ('pdf_url', models.URLField(blank=True, null=True)),
                ('embedding', models.JSONField(blank=True, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('last_indexed', models.DateTimeField(blank=True, null=True)),
            ],
            options={
                'verbose_name': 'Evidence Source',
                'verbose_name_plural': 'Evidence Sources',
                'db_table': 'evidence_sources',
                'ordering': ['-publication_year', '-created_at'],
                'indexes': [models.Index(fields=['pmid'], name='evidence_so_pmid_5d727f_idx'), models.Index(fields=['source_type'], name='evidence_so_source__120bb7_idx'), models.Index(fields=['evidence_strength'], name='evidence_so_evidenc_1f9551_idx')],
            },
        ),
        migrations.CreateModel(
            name='EvidenceLink',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('relevance_type', models.CharField(choices=[('directly_supports', 'Directly Supports'), ('partially_supports', 'Partially Supports'), ('comparative_evidence', 'Comparative Evidence'), ('contraindication', 'Contraindication'), ('related_finding', 'Related Finding')], default='directly_supports', max_length=50)),
                ('relevance_score', models.FloatField(default=0.8)),
                ('how_evidence_supports', models.TextField(blank=True, null=True)),
                ('relevant_excerpts', models.JSONField(blank=True, default=list)),
                ('impact_percentage', models.FloatField(default=0.0)),
                ('evidence_source', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='cancer_detection.evidencesource')),
            ],
            options={
                'verbose_name': 'Evidence Link',
                'verbose_name_plural': 'Evidence Links',
                'db_table': 'evidence_links',
            },
        ),
        migrations.CreateModel(
            name='GenomicProfile',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('mutations', models.JSONField(blank=True, default=dict)),
                ('biomarkers', models.JSONField(blank=True, default=dict)),
                ('copy_number_variations', models.JSONField(blank=True, default=dict)),
                ('pd_l1_status', models.CharField(blank=True, max_length=50, null=True)),
                ('pd_l1_percentage', models.FloatField(blank=True, null=True)),
                ('msi_status', models.CharField(blank=True, max_length=50, null=True)),
                ('tumor_mutational_burden', models.FloatField(blank=True, null=True)),
                ('immune_infiltration', models.CharField(blank=True, max_length=50, null=True)),
                ('analysis_results', models.JSONField(blank=True, default=dict)),
                ('actionable_mutations', models.JSONField(blank=True, default=list)),
                ('targeted_therapy_eligibility', models.JSONField(blank=True, default=dict)),
                ('immunotherapy_eligibility', models.JSONField(blank=True, default=dict)),
                ('prognostic_profile', models.JSONField(blank=True, default=dict)),
                ('test_type', models.CharField(blank=True, max_length=100, null=True)),
                ('test_date', models.DateField(blank=True, null=True)),
                ('lab_name', models.CharField(blank=True, max_length=200, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('analyzed_at', models.DateTimeField(blank=True, null=True)),
                ('patient', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='genomic_profiles', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Genomic Profile',
                'verbose_name_plural': 'Genomic Profiles',
                'db_table': 'genomic_profiles',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='HistopathologyReport',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('report_file', models.FileField(blank=True, null=True, upload_to='histopathology_reports/%Y/%m/%d/')),
                ('report_text', models.TextField(blank=True, null=True)),
                ('status', models.CharField(choices=[('uploaded', 'Uploaded'), ('analyzing', 'Analyzing'), ('analyzed', 'Analyzed'), ('error', 'Error')], default='uploaded', max_length=20)),
                ('analysis_results', models.JSONField(blank=True, default=dict)),
                ('cancer_type', models.CharField(blank=True, max_length=100, null=True)),
                ('cancer_subtype', models.CharField(blank=True, max_length=200, null=True)),
                ('grade', models.CharField(blank=True, max_length=50, null=True)),
                ('stage', models.CharField(blank=True, max_length=50, null=True)),
                ('tnm_staging', models.CharField(blank=True, max_length=50, null=True)),
                ('tumor_size_mm', models.FloatField(blank=True, null=True)),
                ('margin_status', models.CharField(blank=True, max_length=50, null=True)),
                ('lymph_node_status', models.JSONField(blank=True, default=dict)),
                ('biomarkers', models.JSONField(blank=True, default=dict)),
                ('report_date', models.DateField(blank=True, null=True)),
                ('pathologist_name', models.CharField(blank=True, max_length=200, null=True)),
                ('hospital_lab', models.CharField(blank=True, max_length=200, null=True)),
                ('analysis_confidence', models.FloatField(default=0.0)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('analyzed_at', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, null=True)),
                ('patient', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='histopathology_reports', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Histopathology Report',
                'verbose_name_plural': 'Histopathology Reports',
                'db_table': 'histopathology_reports',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='PersonalizedTreatmentPlan',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('plan_name', models.CharField(blank=True, max_length=200, null=True)),
                ('cancer_type', models.CharField(max_length=100)),
                ('cancer_stage', models.CharField(max_length=50)),
                ('patient_profile', models.JSONField(default=dict)),
                ('tumor_analysis', models.JSONField(default=dict)),
                ('genetic_profile', models.JSONField(default=dict)),
                ('primary_treatments', models.JSONField(default=list)),
                ('adjuvant_treatments', models.JSONField(default=list)),
                ('targeted_therapies', models.JSONField(default=list)),
                ('side_effects', models.JSONField(default=list)),
                ('predicted_5yr_survival', models.FloatField(blank=True, null=True)),
                ('remission_probability', models.FloatField(blank=True, null=True)),
                ('quality_of_life_score', models.IntegerField(blank=True, null=True)),
                ('monitoring_plan', models.JSONField(default=dict)),
                ('expected_milestones', models.JSONField(default=list)),
                ('treatment_pathway', models.JSONField(default=dict)),
                ('clinical_trials', models.JSONField(default=list)),
                ('contraindications', models.JSONField(default=list)),
                ('special_considerations', models.TextField(blank=True, null=True)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('pending_review', 'Pending Oncologist Review'), ('approved', 'Approved by Oncologist'), ('active', 'Active/In Progress'), ('completed', 'Completed'), ('archived', 'Archived')], default='draft', max_length=20)),
                ('oncologist_notes', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('review_date', models.DateTimeField(blank=True, null=True)),
                ('activated_date', models.DateTimeField(blank=True, null=True)),
                ('analysis', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='treatment_plans', to='cancer_detection.cancerimageanalysis')),
                ('patient', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='treatment_plans', to=settings.AUTH_USER_MODEL)),
                ('reviewed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='reviewed_plans', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Personalized Treatment Plan',
                'verbose_name_plural': 'Personalized Treatment Plans',
                'db_table': 'personalized_treatment_plans',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='RecommendationEvidence',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('recommendation_type', models.CharField(max_length=200)),
                ('recommendation_text', models.TextField()),
                ('total_evidence_score', models.FloatField(default=0.0)),
                ('high_strength_count', models.IntegerField(default=0)),
                ('moderate_strength_count', models.IntegerField(default=0)),
                ('low_strength_count', models.IntegerField(default=0)),
                ('decision_factors', models.JSONField(default=dict)),
                ('recommendation_confidence', models.FloatField(default=0.0)),
                ('alternative_recommendations', models.JSONField(blank=True, default=list)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('evidence_sources', models.ManyToManyField(through='cancer_detection.EvidenceLink', to='cancer_detection.evidencesource')),
                ('treatment_plan', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='recommendation_evidences', to='cancer_detection.personalizedtreatmentplan')),
            ],
            options={
                'verbose_name': 'Recommendation Evidence',
                'verbose_name_plural': 'Recommendation Evidences',
                'db_table': 'recommendation_evidences',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='evidencelink',
            name='recommendation_evidence',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='cancer_detection.recommendationevidence'),
        ),
        migrations.CreateModel(
            name='EvidenceExplanationLog',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('explanation_type', models.CharField(max_length=50)),
                ('explanation_returned', models.JSONField(default=dict)),
                ('was_helpful', models.BooleanField(blank=True, null=True)),
                ('user_feedback', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('response_time_ms', models.IntegerField(blank=True, null=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='evidence_explanations', to=settings.AUTH_USER_MODEL)),
                ('sources_shown', models.ManyToManyField(to='cancer_detection.evidencesource')),
                ('treatment_plan', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='cancer_detection.personalizedtreatmentplan')),
                ('recommendation_evidence', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='cancer_detection.recommendationevidence')),
            ],
            options={
                'verbose_name': 'Evidence Explanation Log',
                'verbose_name_plural': 'Evidence Explanation Logs',
                'db_table': 'evidence_explanation_logs',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='RuleBasedReference',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('rule_name', models.CharField(max_length=200, unique=True)),
                ('description', models.TextField()),
                ('cancer_type', models.CharField(max_length=100)),
                ('cancer_stage', models.CharField(blank=True, max_length=50, null=True)),
                ('biomarker_requirement', models.JSONField(blank=True, default=dict)),
                ('recommended_treatment', models.CharField(max_length=200)),
                ('guideline_references', models.JSONField(default=list)),
                ('pubmed_references', models.JSONField(default=list)),
                ('evidence_strength', models.CharField(choices=[('high', 'High - Category 1'), ('moderate', 'Moderate - Category 2A/2B'), ('low', 'Low - Category 3')], default='moderate', max_length=20)),
                ('rule_logic', models.TextField()),
                ('priority_level', models.IntegerField(default=0)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_rules', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Rule-Based Reference',
                'verbose_name_plural': 'Rule-Based References',
                'db_table': 'rule_based_references',
                'ordering': ['-priority_level', 'cancer_type'],
            },
        ),
        migrations.CreateModel(
            name='TreatmentOutcome',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('status', models.CharField(choices=[('ongoing', 'Treatment Ongoing'), ('completed', 'Treatment Completed'), ('discontinued', 'Treatment Discontinued'), ('follow_up', 'In Follow-up')], default='ongoing', max_length=20)),
                ('treatment_response', models.CharField(blank=True, max_length=50, null=True)),
                ('response_date', models.DateField(blank=True, null=True)),
                ('progression_free_survival_days', models.IntegerField(blank=True, null=True)),
                ('overall_survival_days', models.IntegerField(blank=True, null=True)),
                ('quality_of_life_score', models.IntegerField(blank=True, null=True)),
                ('quality_of_life_date', models.DateField(blank=True, null=True)),
                ('side_effects_experienced', models.JSONField(blank=True, default=list)),
                ('side_effects_severity', models.JSONField(blank=True, default=dict)),
                ('predicted_survival', models.FloatField(blank=True, null=True)),
                ('predicted_response', models.FloatField(blank=True, null=True)),
                ('actual_survival', models.FloatField(blank=True, null=True)),
                ('actual_response', models.CharField(blank=True, max_length=50, null=True)),
                ('notes', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('patient', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='treatment_outcomes', to=settings.AUTH_USER_MODEL)),
                ('treatment_plan', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='outcomes', to='cancer_detection.personalizedtreatmentplan')),
            ],
            options={
                'verbose_name': 'Treatment Outcome',
                'verbose_name_plural': 'Treatment Outcomes',
                'db_table': 'treatment_outcomes',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AlterUniqueTogether(
            name='evidencelink',
            unique_together={('recommendation_evidence', 'evidence_source')},
        ),
    ]
